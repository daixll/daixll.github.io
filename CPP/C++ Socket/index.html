<!DOCTYPE html><html><head>
      <title>index</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<style>
    .center
    {
    width: auto;
    display: table;
    margin-left: auto;
    margin-right: auto;
    }
</style>
<h1 id="引子">引子 </h1>
<p><strong><a href="https://github.com/daixll/A_Tour_of_Socket">源代码</a></strong></p>
<blockquote>
<p>请务必确定，对以下知识有一定的了解</p>
</blockquote>
<p><strong>TCP / IP 分层模型</strong>：</p>
<table>
<thead>
<tr>
<th style="text-align:center">层</th>
<th style="text-align:center">协议</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">应用层</td>
<td style="text-align:center"><code>HTTP</code> <code>FTP</code> <code>...</code></td>
</tr>
<tr>
<td style="text-align:center">传输层</td>
<td style="text-align:center"><code>TCP</code> <code>UDP</code> <code>...</code></td>
</tr>
<tr>
<td style="text-align:center">网络层</td>
<td style="text-align:center"><code>IPv4</code> <code>IPv6</code> <code>...</code></td>
</tr>
<tr>
<td style="text-align:center">物理层</td>
<td style="text-align:center"><code>LAN</code> <code>WLAN</code> <code>...</code></td>
</tr>
</tbody>
</table>
<p><strong>计算机组成原理</strong>：</p>
<table>
<thead>
<tr>
<th style="text-align:center">设备</th>
<th style="text-align:center">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">数据总线</td>
<td style="text-align:center">传输数据</td>
</tr>
<tr>
<td style="text-align:center">IO设备</td>
<td style="text-align:center">输入输出</td>
</tr>
<tr>
<td style="text-align:center">主存储器</td>
<td style="text-align:center">存储数据</td>
</tr>
<tr>
<td style="text-align:center">CPU</td>
<td style="text-align:center">计算数据</td>
</tr>
</tbody>
</table>
<p><strong>操作系统</strong>：</p>
<ul>
<li>
<p>（内核空间）管理计算机硬件资源进行管理和控制</p>
</li>
<li>
<p>（用户空间）提供系统调用接口，供用户程序调用</p>
</li>
<li>
<p><strong>进程</strong>：为了让计算机能够同时运行多个程序，操作系统引入了进程的概念</p>
</li>
<li>
<p><strong>线程</strong>：线程是 CPU 调度的基本单位，进程是资源分配的基本单位</p>
</li>
</ul>
<br>
<p><strong>参考</strong></p>
<ul>
<li>
<p><strong>书籍</strong></p>
<ul>
<li>《Linux 多线程服务端编程：使用 muduo C++ 网络库》</li>
<li>《Linux 高性能服务器编程》 游双</li>
</ul>
</li>
<li>
<p><strong>博客</strong></p>
<ul>
<li><a href="https://github.com/yuesong-feng/30dayMakeCppServer">30天自制C++服务器</a></li>
<li><a href="https://blog.csdn.net/weixin_50437588/category_12156183.html">webServer</a></li>
</ul>
</li>
</ul>
<br>
<hr>
<h1 id="1-阻塞-io">1 阻塞 IO </h1>
<p>当 <strong>进程</strong> 发起 <strong>IO请求</strong> 后，如果 <strong>内核</strong> 没有准备好数据，那么 <strong>进程</strong> 将一直等待，直到 <strong>内核</strong> 准备好数据为止</p>
<blockquote>
<p>当程序发起发送数据的请求时，如果发送缓冲区已满，那么程序将一直等待，直到发送缓冲区有空间为止</p>
</blockquote>
<blockquote>
<p>当程序发起接收数据的请求时，如果接收缓冲区为空，那么程序将一直等待，直到接收缓冲区有数据为止</p>
</blockquote>
<h2 id="tcp">TCP </h2>
<p><strong>TCP 通信模型</strong></p>
<p>socket 是一个接口，而不是一种协议，其抽象在应用层与传输层之间</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">函数</th>
<th style="text-align:center">服务端</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>socket()</code></td>
<td style="text-align:center">创建 socket</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>bind()</code></td>
<td style="text-align:center">绑定 ip + port 至该 socket 上</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>listen()</code></td>
<td style="text-align:center">监听该 端口</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>accept()</code></td>
<td style="text-align:center">接受来自客户端的连接请求</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>recv()</code></td>
<td style="text-align:center">从 socket 中读取字符</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>close()</code></td>
<td style="text-align:center">关闭 socket</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">函数</th>
<th style="text-align:center">客户端</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>socket()</code></td>
<td style="text-align:center">创建 socket</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>connect()</code></td>
<td style="text-align:center">连接指定 ip + port</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>send()</code></td>
<td style="text-align:center">发送消息</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>close()</code></td>
<td style="text-align:center">关闭 socket</td>
</tr>
</tbody>
</table>
<h3 id="server">server </h3>
<ol>
<li>
<p>创建套接字 <code>socket()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h&gt;</span> <span class="token comment">// socket()</span></span>
</code></pre><pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-int">int</span> server <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建套接字</span>
</code></pre><blockquote>
<p>当 <code>socket()</code> 函数调用成功时，返回一个文件描述符，即 <code>socket</code>，当调用失败时，返回 <code>-1</code></p>
</blockquote>
<ul>
<li><code>AF_INET</code>：IPv4</li>
<li><code>SOCK_STREAM</code>：TCP</li>
<li><code>0</code>：自动选择协议，这里是 <code>TCP</code> 协议</li>
</ul>
</li>
</ol>
<br>
<ol start="2">
<li>
<p>绑定 ip + port <code>bind()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span>     <span class="token comment">// memset()</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h&gt;</span> <span class="token comment">// sockaddr</span></span>
</code></pre><pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token comment">// 服务端地址</span>
sockaddr_in server_addr<span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 给地址赋值</span>
server_addr<span class="token punctuation">.</span>sin_family      <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_port        <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">10086</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 绑定</span>
<span class="token function">bind</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> <span class="token punctuation">(</span>sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><blockquote>
<p>当 <code>bind()</code> 函数调用成功时，返回 <code>0</code>，当调用失败时，返回 <code>-1</code></p>
</blockquote>
<ul>
<li><code>sockaddr_in</code>：IPv4 套接字地址结构体</li>
<li><code>sin_family</code>：地址族，这里是 IPv4</li>
<li><code>sin_addr.s_addr</code>：IPv4 地址</li>
<li><code>sin_port</code>：端口号</li>
</ul>
 <br>
<blockquote>
<p>为什么要强制转换为 <code>sockaddr</code>？<br>
为什么要使用 <code>sockaddr_in</code> 而不是 <code>sockaddr</code>？</p>
<ul>
<li><code>sockaddr</code> 是一个通用的套接字地址结构体，可以用于任何类型的套接字</li>
<li><code>sockaddr_in</code> 是一个 IPv4 套接字地址结构体，只能用于 IPv4 套接字</li>
<li><code>sockaddr_in</code> 是 <code>sockaddr</code> 的子类，可以强制转换为 <code>sockaddr</code></li>
<li>除了 <code>sockaddr_in</code>，还有 <code>sockaddr_in6</code>、<code>sockaddr_un</code> 等</li>
</ul>
</blockquote>
</li>
</ol>
<br>
<ol start="3">
<li>
<p>监听 <code>listen()</code><br>
<br></p>
<blockquote>
<p><strong>成功</strong>：返回 <code>0</code><br>
<strong>失败</strong>：返回 <code>-1</code></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token comment">// 监听</span>
<span class="token function">listen</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li><code>0</code>：等待队列的最大长度，目前无需关注</li>
</ul>
</li>
</ol>
<br>
<ol start="4">
<li>
<p>接受连接请求 <code>accept()</code><br>
<br></p>
<blockquote>
<p><strong>成功</strong>：返回一个文件描述符，<code>fd &gt; 0</code><br>
<strong>失败</strong>：返回 <code>-1</code></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code>sockaddr_in client_addr<span class="token punctuation">;</span>
socklen_t   client_addr_len <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span> client_addr<span class="token punctuation">;</span>
<span class="token keyword keyword-int">int</span> client <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> <span class="token punctuation">(</span>sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>client_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>client_addr_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li><code>socklen_t</code>：<code>sockaddr</code> 的长度类型</li>
</ul>
<blockquote>
<p>为什么这里需要传入 <code>&amp;client_addr_len</code> 而不是 <code>client_addr_len</code>？</p>
<ul>
<li><code>accept()</code> 函数会修改 <code>client_addr_len</code> 的值，所以需要传入指针</li>
</ul>
</blockquote>
</li>
</ol>
<br>
<ol start="5">
<li>
<p>接收消息 <code>recv()</code><br>
<br></p>
<blockquote>
<p><strong>成功</strong>：返回接收的字节数<br>
<strong>错误</strong>：返回 <code>-1</code><br>
<strong>失败</strong>：返回 <code>0</code>，对端关闭连接</p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-char">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">recv</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><blockquote>
<p>通常，<code>recv()</code> 函数返回接收到的字节数，对端关闭返回 <code>0</code>，其余返回 <code>-1</code></p>
</blockquote>
</li>
</ol>
<br>
<ol start="6">
<li>
<p>关闭套接字 <code>close()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token function">close</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<br>
<h3 id="client">client </h3>
<ol>
<li>
<p>创建套接字 <code>socket()</code></p>
</li>
<li>
<p>连接指定 ip + port <code>connect()</code><br>
<br></p>
<blockquote>
<p><strong>成功</strong>：返回 <code>0</code><br>
<strong>失败</strong>：返回 <code>-1</code></p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code>sockaddr_in server_addr<span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 给地址赋值</span>
server_addr<span class="token punctuation">.</span>sin_family      <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_port        <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">10086</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 连接</span>
<span class="token function">connect</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> <span class="token punctuation">(</span>sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>发送消息 <code>send()</code><br>
<br></p>
<blockquote>
<p><strong>成功</strong>：返回发送的字节数<br>
<strong>错误</strong>：返回 <code>-1</code><br>
<strong>失败</strong>：返回 <code>0</code>，对端关闭连接</p>
</blockquote>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-char">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">send</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>关闭套接字 <code>close()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token function">close</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<br>
<h3 id="send-和-recv">send 和 recv </h3>
<ul>
<li><code>&gt; 0</code> 发送或接收的字节数</li>
<li><code>= 0</code> 对端已经关闭连接</li>
<li><code>&lt; 0</code> 出现了错误</li>
</ul>
<br>
<h3 id="tcp-三握四挥">TCP 三握四挥 </h3>
<ul>
<li>
<p>连接</p>
<ol>
<li><code>客户端</code> 请求连接，<code>connect</code> 阻塞</li>
<li><code>服务端</code> 收到请求，<code>accept</code> 阻塞，同时向 <code>客户端</code> 发送确认信息</li>
<li><code>客户端</code> 确认；<code>connect</code> 返回；同时发送信息；<code>accept</code> 返回</li>
</ol>
</li>
<li>
<p>断开</p>
<ol>
<li><code>客户端</code> 请求断开，<code>close</code> 阻塞</li>
<li><code>服务端</code> 发送确认信息（我已知晓）</li>
<li><code>服务端</code> 发送请求信息（请求断开），<code>close</code> 阻塞</li>
<li><code>客户端</code> 收到确认信息，发送确认信息，俩 <code>close</code> 先后返回</li>
</ol>
</li>
<li>
<p>连接之后</p>
<ol>
<li><code>客户端</code> 发送信息，<code>send</code> 阻塞</li>
<li><code>服务端</code> 接收信息，<code>recv</code> 阻塞</li>
<li><code>服务端</code> 发送信息，<code>send</code> 阻塞</li>
<li><code>客户端</code> 接收信息，<code>recv</code> 阻塞</li>
<li>重复 1-4，直到 <code>客户端</code> 或 <code>服务端</code> 断开连接</li>
</ol>
</li>
</ul>
<br>
<hr>
<h2 id="udp">UDP </h2>
<p><strong>UDP 通信模型</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">函数</th>
<th style="text-align:center">服务端</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>socket()</code></td>
<td style="text-align:center">创建 socket</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>bind()</code></td>
<td style="text-align:center">绑定 ip + port 至该 socket 上</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>recvfrom()</code></td>
<td style="text-align:center">接收来自客户端的消息</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>close()</code></td>
<td style="text-align:center">关闭 socket</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">函数</th>
<th style="text-align:center">客户端</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>socket()</code></td>
<td style="text-align:center">创建 socket</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>sendto()</code></td>
<td style="text-align:center">发送消息</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>close()</code></td>
<td style="text-align:center">关闭 socket</td>
</tr>
</tbody>
</table>
<h3 id="server-1">server </h3>
<ol>
<li>
<p>创建套接字 <code>socket()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-int">int</span> server <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 创建套接字</span>
</code></pre><ul>
<li><code>SOCK_DGRAM</code>：UDP</li>
<li><code>0</code>：自动选择协议，这里是 <code>UDP</code> 协议</li>
</ul>
</li>
<li>
<p>绑定 ip + port <code>bind()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token comment">// 服务端地址</span>
sockaddr_in server_addr<span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 给地址赋值</span>
server_addr<span class="token punctuation">.</span>sin_family      <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_port        <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">10086</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 绑定</span>
<span class="token function">bind</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> <span class="token punctuation">(</span>sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>接收消息 <code>recvfrom()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token comment">// 缓冲区</span>
<span class="token keyword keyword-char">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 客户端地址</span>
sockaddr_in client_addr<span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>client_addr<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> client_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
socklen_t   client_addr_len <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span> client_addr<span class="token punctuation">;</span>
<span class="token comment">// 接收消息</span>
<span class="token function">recvfrom</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>client_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>client_addr_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>关闭套接字 <code>close()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token function">close</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<h3 id="client-1">client </h3>
<ol>
<li>
<p>创建套接字 <code>socket()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-int">int</span> server <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 创建套接字</span>
</code></pre></li>
<li>
<p>发送消息 <code>sendto()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token comment">// 服务端地址</span>
sockaddr_in server_addr<span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 给地址赋值</span>
server_addr<span class="token punctuation">.</span>sin_family      <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server_addr<span class="token punctuation">.</span>sin_port        <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">10086</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 发送消息</span>
<span class="token keyword keyword-char">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sendto</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>server_addr<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span> server_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>关闭套接字 <code>close()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token function">close</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<br>
<hr>
<h2 id="http-">HTTP * </h2>
<p>HTTP 协议是基于 TCP 协议的应用层协议，默认端口号是 80（HTTPS是 443），HTTP 协议的通信模型是 <strong>请求-响应</strong> 模型</p>
<ul>
<li>请求，即客户端向服务端发送的消息</li>
<li>响应，即服务端向客户端发送的消息</li>
</ul>
<p>HTTP 协议的请求消息和响应消息都是由 <strong>请求 / 响应行</strong>、<strong>请求 / 响应头</strong>、<strong>请求 / 响应体</strong> 组成</p>
<ul>
<li>
<p><strong>请求行</strong> 由三部分组成：请求方法、请求路径、HTTP版本</p>
<ul>
<li>
<p>请求方法：</p>
<ul>
<li><strong>GET：</strong>
<ul>
<li><strong>用途：</strong> 请求获取指定资源.不应该对服务器端数据产生任何影响。</li>
<li><strong>示例：</strong> <code>GET /index.html</code>，获取首页信息。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>
<p><strong>POST：</strong></p>
<ul>
<li><strong>用途：</strong> 用于向指定资源提交数据，请求服务器进行处理。常用于提交表单数据或上传文件。</li>
<li><strong>示例：</strong> <code>POST /users</code>，提交用户注册表单。</li>
</ul>
</li>
<li>
<p><strong>PUT：</strong></p>
<ul>
<li><strong>用途：</strong> 请求服务器存储一个资源。通常是更新已存在的资源或创建新资源。</li>
<li><strong>示例：</strong> <code>PUT /products/123</code>，更新产品编号为123的商品信息。</li>
</ul>
</li>
<li>
<p><strong>DELETE：</strong></p>
<ul>
<li><strong>用途：</strong> 请求服务器删除指定的资源。</li>
<li><strong>示例：</strong> <code>DELETE /users/456</code>，删除用户编号为456的用户信息。</li>
</ul>
</li>
<li>
<p><strong>HEAD：</strong></p>
<ul>
<li><strong>用途：</strong> 请求获取指定资源的响应头信息，而不获取响应体的内容。通常用于检查资源是      否存在或获取资源的元信息。</li>
<li><strong>示例：</strong> <code>HEAD /documents/789</code>，检查文档编号为789的资源是否存在。</li>
</ul>
</li>
<li>
<p><strong>OPTIONS：</strong></p>
<ul>
<li><strong>用途：</strong> 请求获取目标资源所支持的通信选项。用于查询服务器支持的HTTP方法。</li>
<li><strong>示例：</strong> <code>OPTIONS /products</code>，查询服务器支持的HTTP方法。</li>
</ul>
</li>
<li>
<p><strong>TRACE：</strong></p>
<ul>
<li><strong>用途：</strong> 用于追踪路径。发送请求时，服务器会返回该请求所经过的服务器路径。主要用      于调试和测试。</li>
<li><strong>示例：</strong> <code>TRACE /debug</code>，追踪请求的路径。</li>
</ul>
</li>
<li>
<p><strong>CONNECT：</strong></p>
<ul>
<li><strong>用途：</strong> 用于建立与目标资源的隧道连接，通常用于加密连接，如HTTPS。</li>
<li><strong>示例：</strong> <code>CONNECT www.example.com:443</code>，与目标服务器建立加密连接。</li>
</ul>
</li>
</ol>
</li>
<li>
<p>请求路径：<code>/</code>、<code>/index.html</code>、<code>/jiao.html</code>、<code>...</code></p>
<ul>
<li>我们将请求路径称为 <code>URI</code>，即统一资源标识符，而 <code>URL</code> 是 <code>URI</code> 的子集</li>
</ul>
</li>
<li>
<p>HTTP版本：<code>HTTP/1.0</code>、<code>HTTP/1.1</code>、<code>HTTP/2.0</code><br>
<br></p>
</li>
</ul>
</li>
<li>
<p><strong>请求头</strong> 由请求头字段和请求头字段值组成，每个请求头字段都有特定的含义，常见的请求头字段有：</p>
<ul>
<li><code>Accept</code>：指定客户端能够接收的内容类型</li>
<li><code>Accept-Encoding</code>：指定客户端能够接收的内容编码方式</li>
<li><code>Accept-Language</code>：指定客户端能够接收的语言</li>
<li><code>Connection</code>：指定客户端与服务端的连接类型</li>
<li><code>Host</code>：指定请求的主机名和端口号</li>
<li><code>User-Agent</code>：指定客户端的类型</li>
<li><code>Referer</code>：指定请求的来源页面</li>
<li><code>Cookie</code>：指定请求的 Cookie</li>
<li><code>Content-Type</code>：指定请求体的类型</li>
<li><code>Content-Length</code>：指定请求体的长度</li>
<li><code>Authorization</code>：指定请求的授权信息</li>
<li><code>If-Modified-Since</code>：指定请求的资源的最后修改时间</li>
<li><code>If-None-Match</code>：指定请求的资源的 ETag 值</li>
</ul>
</li>
</ul>
<br>
<ul>
<li><strong>请求体</strong> 具体的数据
<ul>
<li>通常是在 post 请求中，将表单数据放在请求体中</li>
</ul>
</li>
</ul>
<br>
<ul>
<li>
<p><strong>响应行</strong> 由三部分组成：HTTP版本、状态码、状态码描述</p>
<ul>
<li>HTTP版本：<code>HTTP/1.0</code>、<code>HTTP/1.1</code>、<code>HTTP/2.0</code></li>
<li>状态码：<code>200</code>、<code>404</code>、<code>500</code>、<code>...</code></li>
<li>状态码描述：<code>OK</code>、<code>Not Found</code>、<code>Internal Server Error</code>、<code>...</code></li>
<li>例如：<code>HTTP/1.1 200 OK</code></li>
</ul>
</li>
</ul>
<br>
<ul>
<li><strong>响应头</strong> 由响应头字段和响应头字段值组成，每个响应头字段都有特定的含义，常见的响应头字段有：
<ul>
<li><code>Content-Type</code>：指定响应体的类型</li>
<li><code>Content-Length</code>：指定响应体的长度</li>
<li><code>Content-Encoding</code>：指定响应体的编码方式</li>
<li><code>Content-Language</code>：指定响应体的语言</li>
<li><code>Content-Disposition</code>：指定响应体的处理方式</li>
<li><code>Set-Cookie</code>：指定响应的 Cookie</li>
<li><code>Location</code>：指定响应的重定向地址</li>
<li><code>Last-Modified</code>：指定响应的资源的最后修改时间</li>
<li><code>ETag</code>：指定响应的资源的 ETag 值</li>
</ul>
</li>
</ul>
<br>
<ul>
<li><strong>响应体</strong> 具体的数据
<ul>
<li>例如网页的 HTML 代码</li>
<li>例如图片的二进制数据、pdf文件等</li>
</ul>
</li>
</ul>
<br>
<hr>
<h2 id="boostasio-">Boost.Asio * </h2>
<br>
<hr>
<h1 id="2-非阻塞-io">2 非阻塞 IO </h1>
<p>当 <strong>进程</strong> 发起 <strong>IO请求</strong> 后，即使 <strong>内核</strong> 没有准备好数据，<strong>进程</strong> 也将立即返回，不会等待，同时 <strong>内核</strong> 会返回一个错误码，告诉 <strong>进程</strong> 为什么没有准备好数据</p>
<h2 id="非阻塞输入">非阻塞输入 </h2>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code>std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">.</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 关闭同步</span>
<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">.</span><span class="token function">rdbuf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">in_avail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// 如果输入缓冲区有数据</span>
    std<span class="token double-colon punctuation">::</span><span class="token function">getline</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 读取数据</span>
</code></pre><h2 id="c2s">c2s </h2>
<p>此时，我们可以构建一个简单的 c2s 通信模型：<br>
<strong>多个</strong> 客户端可以与 <strong>一个</strong> 服务端 <strong>收发任意条</strong> 消息</p>
<p><strong><code>server</code>：</strong></p>
<ol>
<li>
<p>创建套接字 <code>socket()</code></p>
</li>
<li>
<p>绑定 ip + port <code>bind()</code></p>
</li>
<li>
<p>监听 <code>listen()</code></p>
</li>
<li>
<p>设置套接字为非阻塞 <code>fcntl()</code></p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span>      <span class="token comment">// fcntl()</span></span>
</code></pre><pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token function">fcntl</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> F_SETFL<span class="token punctuation">,</span> O_NONBLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li><code>fcntl()</code>：控制文件描述符属性<br>
<code>int fcntl(int fd, int cmd, ... /* arg */ );</code>
<ul>
<li><code>fd</code>：文件描述符</li>
<li><code>cmd</code>：操作命令，对 <code>fd</code> 进行操作
<ul>
<li><code>F_SETFL</code>：设置文件描述符状态标志</li>
<li><code>F_GETFL</code>：获取文件描述符状态标志</li>
</ul>
</li>
<li><code>arg</code>：操作命令的参数，根据 <code>cmd</code> 的不同而不同
<ul>
<li><code>O_NONBLOCK</code>：非阻塞</li>
<li><code>O_ASYNC</code>：异步</li>
<li><code>O_SYNC</code>：同步</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>循环接受连接请求 <code>accept()</code></p>
</li>
<li>
<p>循环接收 <code>recv()</code> 和发送 <code>send()</code> 消息</p>
</li>
<li>
<p>关闭套接字 <code>close()</code></p>
</li>
</ol>
<p><strong><code>client</code>：</strong></p>
<ol>
<li>创建套接字 <code>socket()</code></li>
<li>连接指定 ip + port <code>connect()</code></li>
<li>设置套接字为非阻塞 <code>fcntl()</code></li>
<li>循环发送 <code>send()</code> 和接收 <code>recv()</code> 消息</li>
<li>关闭套接字 <code>close()</code></li>
</ol>
<br>
<hr>
<h2 id="echo-server">echo server </h2>
<p>echo server，即客户端发送什么，服务端就回复什么<br>
在 c2s 的基础上，初步尝试使用面向对象的思想实现：</p>
<ul>
<li><code>SockAddr</code>：套接字地址类</li>
<li><code>Event</code>：事件类，包含事件处理函数</li>
<li><code>Acceptor</code>：接收器类</li>
</ul>
<br>
<hr>
<h2 id="http-server">http server </h2>
<p>在 echo server 中，使用 deal 函数处理接收到的消息，如果想处理 http 请求，只需要重写 deal 函数即可：</p>
<ul>
<li>获取 http 请求的请求</li>
<li>解析 http 请求的请求</li>
<li>构造 http 响应的响应</li>
<li>发送 http 响应的响应</li>
</ul>
<br>
<hr>
<h2 id="c2c">c2c </h2>
<p>之前的 c2s 通信模型，是多个客户端与一个服务端收发任意条消息，现在我们尝试构建一个 c2c 通信模型：</p>
<ul>
<li>每个客户端可以与任意个客户端建立连接</li>
<li>每个客户端可以与任意个客户端收发任意条消息</li>
</ul>
<br>
<hr>
<h1 id="3-复用-io">3 复用 IO </h1>
<p>在阻塞 IO 中，如何没有连接请求，<code>accept()</code> 函数将一直阻塞，直到有连接请求为止，<code>recv()</code> 和 <code>send()</code> 函数也是如此，如果没有数据，将一直阻塞，直到有数据为止。</p>
<p>在非阻塞 IO 中，我们采取循环的方式，不断的调用 <code>accept()</code>、<code>recv()</code>、<code>send()</code> 函数，如果没有接收到连接请求或数据，那么函数将立即返回，不会等待，同时内核会返回一个错误码，告诉进程为什么没有准备好数据。</p>
<p>在 IO 复用 中，我们可以使用 <code>select()</code>、<code>poll()</code>、<code>epoll()</code> 函数，将多个文件描述符注册到内核中，当有文件描述符准备好数据时，内核将通知进程，进程再调用 <code>accept()</code>、<code>recv()</code>、<code>send()</code> 函数，这样就不需要循环调用这些函数了。</p>
<h2 id="c2s_epoll">c2s_epoll </h2>
<p>在 c2s 的基础上，使用 <code>epoll()</code> 函数实现 IO 复用，客户端是非阻塞的普通客户端。</p>
<br>
<p>eventpoll，事件轮询，Linux 内核实现IO多路复用（IO multiplexing）的一个实现</p>
<p>直观来说，I/O 复用的作用就是：让程序能够在单进程、单线程的模式下，同时处理 <strong>多个文件描述符</strong> 的 I/O 请求</p>
<ul>
<li>底层创建一个 红黑树 和 就绪链表（双向链表）</li>
<li>红黑树 存储所监控的文件描述符的节点数据，就绪链表 存储就绪的文件描述符的节点数据</li>
</ul>
<ol>
<li>
<p><code>epoll_create1</code> 创建一个 epoll 文件描述符，事件轮询的实例，返回一个文件描述符，即事件树</p>
<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/epoll.h&gt;</span>  <span class="token comment">// epoll_create1()</span></span>
</code></pre><pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-int">int</span> epollfd <span class="token operator">=</span> <span class="token function">epoll_create1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li><code>0</code>：等待队列的最大长度</li>
</ul>
</li>
<li>
<p><code>int epoll_ctl(事件树, 操作, 文件描述符, 事件)</code></p>
<ul>
<li>操作：
<ul>
<li><code>EPOLL_CTL_ADD</code>：注册新的事件到事件树</li>
<li><code>EPOLL_CTL_MOD</code>：修改已经注册的事件</li>
<li><code>EPOLL_CTL_DEL</code>：删除已经注册的事件</li>
</ul>
</li>
<li>事件：
<ul>
<li><code>EPOLLIN</code>：对应的文件描述符可以读 <code>recv</code> （包括对端SOCKET正常关闭）</li>
<li><code>EPOLLPRI</code>：对应的文件描述符有紧急的数据可读（这里应该表示有带外数据到来）</li>
<li><code>EPOLLOUT</code>：对应的文件描述符可以写 <code>send</code>（包括对端SOCKET正常关闭）</li>
<li><code>EPOLLERR</code>：对应的文件描述符发生错误</li>
<li><code>EPOLLHUP</code>：对应的文件描述符被挂断</li>
<li><code>EPOLLET</code>：将 EPOLL 设为边缘触发(Edge Triggered)模式</li>
<li><code>EPOLLONESHOT</code>：只监听一次事件，当监听完这次事件之后，删除</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>int epoll_wait(事件树, 事件数组, 事件数组大小, 超时时间)</code></p>
<ul>
<li>事件数组：<code>epoll_event</code> 结构体数组</li>
<li>超时时间：<code>-1</code> 阻塞，<code>0</code> 立即返回，<code>&gt;0</code> 等待指定时间</li>
</ul>
</li>
</ol>
<br>
<p>一些数据结构</p>
<ul>
<li><code>epoll_event</code> 事件结构体，用于注册事件<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/epoll.h&gt;</span>  <span class="token comment">// epoll_event</span></span>
</code></pre><pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-struct">struct</span> <span class="token class-name">epoll_event</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-uint32_t">uint32_t</span> events<span class="token punctuation">;</span>    <span class="token comment">// 事件类型</span>
    epoll_data_t data<span class="token punctuation">;</span>  <span class="token comment">// 用户数据，一个联合体</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><ul>
<li><code>events</code>：事件类型</li>
<li><code>data</code>：用户数据
<ul>
<li><code>epoll_data_t</code>：用户数据类型<pre data-role="codeBlock" data-info="cpp" class="language-cpp cpp"><code><span class="token keyword keyword-typedef">typedef</span> <span class="token keyword keyword-union">union</span> epoll_data
<span class="token punctuation">{</span>
    <span class="token keyword keyword-void">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>      <span class="token comment">// 指针</span>
    <span class="token keyword keyword-int">int</span> fd<span class="token punctuation">;</span>         <span class="token comment">// 文件描述符</span>
    <span class="token keyword keyword-uint32_t">uint32_t</span> u32<span class="token punctuation">;</span>   <span class="token comment">// 32位无符号整数</span>
    <span class="token keyword keyword-uint64_t">uint64_t</span> u64<span class="token punctuation">;</span>   <span class="token comment">// 64位无符号整数</span>
<span class="token punctuation">}</span> epoll_data_t<span class="token punctuation">;</span>
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="4-信号驱动-io">4 信号驱动 IO </h1>
<h2 id="tcp-1">TCP </h2>
<br>
<hr>
<h1 id="5-异步-io">5 异步 IO </h1>
<p>前 4 种 IO 模型都是同步 IO，即用户进程发起 IO 请求后，需要等待内核完成 IO 操作后才能继续执行</p>
<br>
<hr>
<h1 id="errno">errno </h1>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">错误码</th>
<th style="text-align:center">别名</th>
<th style="text-align:center">错误描述</th>
<th style="text-align:center">note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>EINTR</code></td>
<td style="text-align:center">信号中断</td>
<td style="text-align:center">通常是由于用户按下了 <code>Ctrl + C</code></td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center"></td>
<td style="text-align:center">文件描述符无效</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center"><code>EAGAIN</code> <code>EWOULDBLOCK</code></td>
<td style="text-align:center">操作被阻塞</td>
<td style="text-align:center">非阻塞下，没有数据可读或写</td>
</tr>
<tr>
<td style="text-align:center">98</td>
<td style="text-align:center"></td>
<td style="text-align:center">地址已经在使用</td>
<td style="text-align:center">通常是 <code>bind()</code> 时，地址已经被占用</td>
</tr>
<tr>
<td style="text-align:center">107</td>
<td style="text-align:center"></td>
<td style="text-align:center">传输终点没有连接</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>
<h1 id="socket">Socket </h1>
<ul>
<li><a href="#tcp--ip-%E5%88%86%E5%B1%82%E6%A8%A1%E5%9E%8B">TCP / IP 分层模型</a> 及 <a href="#tcp-%E4%B8%89%E6%8F%A1%E5%9B%9B%E6%8C%A5">三握四挥</a></li>
<li><a href="#socket-tcp-%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9E%8B">socket TCP 通信模型</a> 及 <a href="#socket-tcp-%E9%80%9A%E4%BF%A1%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B">实例</a></li>
<li><a href="#socket-udp-%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9E%8B">socket UDP 通信模型</a> 及 <a href="#socket-udp-%E9%80%9A%E4%BF%A1%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B">实例</a></li>
<li>网络IO接口复用：select、poll、<a href="#epoll">epoll</a></li>
<li>阻塞、<a href="#%E9%9D%9E%E9%98%BB%E5%A1%9E-socket">非阻塞</a>、<a href="#socket-%E9%80%89%E9%A1%B9">Socket选项</a></li>
<li>同步、异步</li>
<li>HTTP协议</li>
</ul>
<h2></h2>
<h2 id="socket-udp-通信简单实例">socket UDP 通信简单实例 </h2>
<ul>
<li>启动 <a href="%E6%A0%B7%E4%BE%8B/UDP%E9%80%9A%E4%BF%A1%E6%A0%B7%E4%BE%8B/%E6%9C%8D%E5%8A%A1%E7%AB%AF.cpp">服务端</a>
<ol>
<li>编译 <code>g++ 服务端.cpp -o 服务端</code></li>
<li>运行 <code>./服务端</code> 默认运行在本地 8080 端口</li>
</ol>
</li>
<li>启动 <a href="%E6%A0%B7%E4%BE%8B/UDP%E9%80%9A%E4%BF%A1%E6%A0%B7%E4%BE%8B/%E5%AE%A2%E6%88%B7%E7%AB%AF.cpp">客户端</a>
<ol>
<li>编译 <code>g++ 客户端.cpp -o 客户端</code></li>
<li>运行 <code>./客户端</code></li>
</ol>
</li>
</ul>
<p>可以同时运行多个客户端，服务端允许多台客户端连接；连接之后：</p>
<ol>
<li>客户端发送消息，服务端接收消息，回复单一消息</li>
<li>服务端发送消息，客户端接收消息，回复单一消息</li>
<li>不断重复，直到客户端断开连接</li>
</ol>
<h2 id="socket-选项">Socket 选项 </h2>
<ul>
<li>
<p><code>int setsockopt(int sockfd, int level, int optname, const void *optval, socklen_t optlen);</code></p>
<ul>
<li><code>sockfd</code>：文件描述符</li>
<li><code>level</code>：选项定义的层次
<ul>
<li><code>SOL_SOCKET</code>：通用套接字选项</li>
<li><code>IPPROTO_IP</code>：IP选项</li>
<li><code>IPPROTO_TCP</code>：TCP选项</li>
<li><code>IPPROTO_IPV6</code>：IPv6选项</li>
</ul>
</li>
<li><code>optname</code>：选项名称
<ul>
<li><code>SO_REUSEADDR</code>：允许重用本地地址和端口</li>
<li><code>SO_REUSEPORT</code>：允许重用本地地址和端口</li>
<li><code>SO_KEEPALIVE</code>：开启 TCP Keep-Alive</li>
<li><code>SO_LINGER</code>：关闭 socket 时，底层会将发送缓冲区的数据发送给对端，然后等待一段时间，如果还没收到对端的确认信息，就强制关闭 socket</li>
<li><code>SO_RCVBUF</code>：设置接收缓冲区大小</li>
<li><code>SO_SNDBUF</code>：设置发送缓冲区大小</li>
<li><code>TCP_NODELAY</code>：禁用 Nagle 算法</li>
<li><code>TCP_MAXSEG</code>：设置 TCP 最大分段大小</li>
<li><code>TCP_CORK</code>：开启 TCP_CORK，关闭 Nagle 算法</li>
<li><code>TCP_QUICKACK</code>：开启 TCP_QUICKACK，关闭延迟确认</li>
</ul>
</li>
<li><code>optval</code>：选项值</li>
<li><code>optlen</code>：选项值长度</li>
</ul>
</li>
<li>
<p><code>int getsockopt(int sockfd, int level, int optname, void *optval, socklen_t *optlen);</code></p>
<ul>
<li><code>sockfd</code>：文件描述符</li>
<li><code>level</code>：选项定义的层次</li>
<li><code>optname</code>：选项名称</li>
<li><code>optval</code>：选项值</li>
<li><code>optlen</code>：选项值长度</li>
</ul>
</li>
</ul>
<h2 id="非阻塞-socket">非阻塞 Socket </h2>
<ul>
<li><code>int fcntl(int fd, int cmd, ... /* arg */ );</code>
<ul>
<li><code>fd</code>：文件描述符</li>
<li><code>cmd</code>：
<ul>
<li><code>F_GETFL</code>：获取文件描述符状态标志</li>
<li><code>F_SETFL</code>：设置文件描述符状态标志</li>
</ul>
</li>
<li><code>arg</code>：文件描述符状态标志
<ul>
<li><code>O_NONBLOCK</code>：非阻塞</li>
<li><code>O_ASYNC</code>：异步</li>
<li><code>O_SYNC</code>：同步</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>阻塞：调用函数时，如果数据没有准备好，那么函数将一直等待，直到数据准备好为止</p>
<p>非阻塞：调用函数时，如果数据没有准备好，那么函数将立即返回，不会等待数据准备好</p>
<ul>
<li>
<p><code>accept</code></p>
<ul>
<li>阻塞：没有新连接时，一直等待</li>
<li>非阻塞：没有新连接时，立即返回 <code>EWOULDBLOCK(11)</code> 或 <code>EAGAIN</code></li>
</ul>
</li>
<li>
<p><code>recv</code></p>
<ul>
<li>阻塞：没有数据时，一直等待</li>
<li>非阻塞：没有数据时，立即返回 <code>EWOULDBLOCK(11)</code> 或 <code>EAGAIN</code></li>
</ul>
</li>
<li>
<p><code>read</code></p>
<ul>
<li>阻塞：没有数据时，一直等待</li>
<li>非阻塞：没有数据时，立即返回 <code>EWOULDBLOCK(11)</code> 或 <code>EAGAIN</code></li>
</ul>
</li>
</ul>
<h2 id="epoll">Epoll </h2>
<h2 id="epoll-通信实例">Epoll 通信实例 </h2>
<ul>
<li>启动 <a href="%E6%A0%B7%E4%BE%8B/%E4%BA%8B%E4%BB%B6%E8%BD%AE%E8%AF%A2%E6%A0%B7%E4%BE%8B/%E6%9C%8D%E5%8A%A1%E7%AB%AF.cpp">服务端</a>
<ol>
<li>编译 <code>g++ 服务端.cpp -o 服务端</code></li>
<li>运行 <code>./服务端</code> 默认运行在本地 8080 端口</li>
</ol>
</li>
<li>启动 <a href="%E6%A0%B7%E4%BE%8B/%E4%BA%8B%E4%BB%B6%E8%BD%AE%E8%AF%A2%E6%A0%B7%E4%BE%8B/%E5%AE%A2%E6%88%B7%E7%AB%AF.cpp">客户端</a>
<ol>
<li>编译 <code>g++ 客户端.cpp -o 客户端</code></li>
<li>运行 <code>./客户端</code></li>
</ol>
</li>
</ul>
<p>可以同时运行多个客户端，服务端允许多台客户端连接连接之后：</p>
<ol>
<li>客户端发送消息，服务端接收消息，回复单一消息</li>
</ol>
<h2 id="面向对象">面向对象 </h2>
<h2 id="channel">Channel </h2>
<p><code>Channel</code> 是 <code>Epoll</code> 的事件处理类，<code>Epoll</code> 通过 <code>Channel</code> 处理事件</p>
<br>
<hr>
<h1 id="boostasio">Boost.Asio </h1>
<p><a href="https://www.boost.org/doc/libs/1_83_0/doc/html/boost_asio.html">Boost.Asio</a></p>

      </div>
      <div class="md-sidebar-toc">
<div class="md-toc">
<div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#引子" class="md-toc-link">
            <p>引子</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#1-阻塞-io" class="md-toc-link"><p>1 阻塞 IO</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#tcp" class="md-toc-link"><p>TCP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#server" class="md-toc-link">
            <p>server</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#client" class="md-toc-link">
            <p>client</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#send-和-recv" class="md-toc-link">
            <p>send 和 recv</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#tcp-三握四挥" class="md-toc-link">
            <p>TCP 三握四挥</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#udp" class="md-toc-link"><p>UDP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#server-1" class="md-toc-link">
            <p>server</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#client-1" class="md-toc-link">
            <p>client</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#http-" class="md-toc-link">
            <p>HTTP *</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#boostasio-" class="md-toc-link">
            <p>Boost.Asio *</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#2-非阻塞-io" class="md-toc-link"><p>2 非阻塞 IO</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#非阻塞输入" class="md-toc-link">
            <p>非阻塞输入</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#c2s" class="md-toc-link">
            <p>c2s</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#echo-server" class="md-toc-link">
            <p>echo server</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#http-server" class="md-toc-link">
            <p>http server</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#c2c" class="md-toc-link">
            <p>c2c</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#3-复用-io" class="md-toc-link"><p>3 复用 IO</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#c2s_epoll" class="md-toc-link">
            <p>c2s_epoll</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#4-信号驱动-io" class="md-toc-link"><p>4 信号驱动 IO</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#tcp-1" class="md-toc-link">
            <p>TCP</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#5-异步-io" class="md-toc-link">
            <p>5 异步 IO</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#errno" class="md-toc-link">
            <p>errno</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#socket" class="md-toc-link"><p>Socket</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#" class="md-toc-link">
            
          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#socket-udp-通信简单实例" class="md-toc-link">
            <p>socket UDP 通信简单实例</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#socket-选项" class="md-toc-link">
            <p>Socket 选项</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#非阻塞-socket" class="md-toc-link">
            <p>非阻塞 Socket</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#epoll" class="md-toc-link">
            <p>Epoll</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#epoll-通信实例" class="md-toc-link">
            <p>Epoll 通信实例</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#面向对象" class="md-toc-link">
            <p>面向对象</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#channel" class="md-toc-link">
            <p>Channel</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#boostasio" class="md-toc-link">
            <p>Boost.Asio</p>

          </a></div>
</div>
</div>
      <a id="sidebar-toc-btn">≡</a>
    
    
    
    
    
    
<script>
document.body.setAttribute('html-show-sidebar-toc', true)
var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>