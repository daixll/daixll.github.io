---
html:
    toc: true           # 打开侧边目录
    toc_depth: 6        # 打开的目录层级
    toc_float: true     # 侧边悬停
    collapsed: true     # 只显示高级别标题(2)
    smooth_scroll: true # 页面滚动,标题变化
    number_sections: false  # 显示标题编号
    theme: united
--- 

# 前缀和
当构造好一个前缀和数组 `O(n)`, 可以在 `O(1)` 的时间内查询到区间和 `(l-r)` 的和 
```cpp
for(int i=1; i<=n; i++) pre[i] = pre[i-1] + a[i]; 
```
```cpp
pre[r] - pre[l-1] // 即 l-r 的区间和
```

## 一维

最大子段和

最大子序和

<details><summary><a href="https://www.acwing.com/problem/content/4647/" target="_blank">AcWing 4644. 求和</a> code</summary> 

```cpp
#include <iostream>
using namespace std;

typedef long long LL;

const int N=2e5+10;

LL a[N];

int n;
LL ans;

int main(){
    cin>>n;
    for(int i=1; i<=n; i++) 
        scanf("%d", a+i), a[i]+=a[i-1];
    
    for(int i=1; i<=n; i++)
       ans += (a[i]-a[i-1])*(a[n]-a[i]); 
    
    cout<<ans;
    
    return 0;
}
```
</details>


<details><summary><a href="https://www.acwing.com/problem/content/3791/" target="_blank">AcWing 3956. 截断数组(两段)</a> code</summary> 

```cpp
#include <iostream>
using namespace std;

const int N=1e5+10;

int a[N];
int n;

int main(){
    cin>>n;
    for(int i=1; i<=n; i++)
        scanf("%d", a+i), a[i]+=a[i-1];
    
    for(int i=1; i<n; i++)
        if( 2 * a[i] == a[n] )  // a[i] == a[n]-a[i]
            (*a)++;
    
    cout<<*a;
    
    return 0;
}
```
</details>




<details><summary><a href="https://www.acwing.com/problem/content/description/3959/" target="_blank">AcWing 3956. 截断数组(三段)</a> code</summary> 

```cpp
#include <iostream>
using namespace std;

typedef long long LL;

const int N=1e5+10;

int a[N];
int n;
LL res;

int main(){
    cin>>n;
    for(int i=1; i<=n; i++)
        scanf("%d", a+i), a[i]+=a[i-1];
    
    if(a[n]%3==0)
    for(int i=1; i<=n-2; i++){
        if( a[n]/3 == a[i] ) (*a)++;         
        if( a[n]/3 == a[n]-a[i+1] ) res+=*a;    // 此写法是保证后面只有一坨
    }
    
    cout<<res;
    
    return 0;
}
```
</details>



<details><summary><a href="https://www.acwing.com/problem/content/description/4300/" target="_blank">AcWing 4297. 截断数组</a> code</summary> 

```cpp
#include <iostream>
using namespace std;

typedef long long LL;

const int N = 2e5+10;

LL a[N];
int n;

int main(){
    cin>>n;
    for(int i=1; i<=n; i++) 
        scanf("%lld", a+i), a[i]+=a[i-1];
    
    int l=1, r=n;
        
    if(n!=1)
    while(l<r)
        if( a[l] == a[n]-a[r-1] )
            (*a) = a[l], l++;
        else if( a[l] < a[n]-a[r-1] ) l++;
        else if( a[l] > a[n]-a[r-1] ) r--;
    
    cout<<(*a);
    
    return 0;
}
```
</details>











<details><summary><a href="https://www.acwing.com/problem/content/description/1232/" target="_blank">AcWing 1230. K倍区间</a> code</summary> 

```cpp
#include <iostream>
using namespace std;

typedef long long LL;

const int N=1e5+10;

LL a[N];
LL cnt[N], sum, res;

int n, k;

int main(){
    scanf("%d%d", &n, &k);
    
    /*
    for(int i=1; i<=n; i++)
        scanf("%d", a+i), a[i]+=a[i-1];
    
    for(int r=1; r<=n; r++)
        for(int l=1; l<=r; l++)
            if( (a[r]-a[l-1]) % k ==0 ) res++;
    cout<<res;
    return 0;
    
    // 当 a[r]%k == a[l-1]%k, res++
    // 对于右边部分 a[l-1]%k 而言, 当r固定, l范围( 1-1 -> r-1 ), 即 [0,r-1]
    // 当 a[r]%k == a[0, r-1]%k, res++
    */
    
    cnt[ a[0]%k ]++;
    for(int i=1; i<=n; i++){
        LL x;
        scanf("%lld", &x), sum+=x;
        res+=cnt[sum%k];
        cnt[sum%k]++;
    }

    // 此代码忽略了 a[0] 的情况,
    // 当 a[r]%k == a[0]%k == 0, res++

    cout<<res;

    return 0;
}
```
</details>






## 二维

<details><summary><a href="https://www.luogu.com.cn/problem/P3397" target="_blank">Luogu P3397 地毯</a> code</summary> 

```cpp


```
</details>




--- 
# 差分



---
# 练习



<details><summary><a href="https://www.acwing.com/problem/content/101/" target="_blank">AcWing 99. 激光炸弹</a> code</summary> 

```cpp


```
</details>



<details><summary><a href="https://www.acwing.com/problem/content/102/" target="_blank">AcWing 100. 增减序列</a> code</summary> 

```cpp


```
</details>



<details><summary><a href="https://www.acwing.com/problem/content/103/" target="_blank">AcWing 101. 最高的牛</a> code</summary> 

```cpp


```
</details>



<details><summary><a href="" target="_blank">AcWing </a> code</summary> 

```cpp


```
</details>








